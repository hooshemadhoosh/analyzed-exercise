from os import walk
import random
import re
import pandas as pd
import pickle
"""
[('اسکوات توانی', ('Fitness\\Core\\Intermediate\\1_01.jpg',)), ('اسکوات تک پا روی استپ', ('Fitness\\Core\\Intermediate\\2_01.jpg', 'Fitness\\Core\\Intermediate\\2_02.jpg')), ('بالا آوردن پا در حلت خوابیده به پهلو', ('Fitness\\Core\\Intermediate\\3_01.jpg', 'Fitness\\Core\\Intermediate\\3_02.jpg', 'Fitness\\Core\\Intermediate\\3_03.jpg')), ('بالا آوردن پاها با توپ مدیسنبال', ('Fitness\\Core\\Intermediate\\4_01.jpg', 'Fitness\\Core\\Intermediate\\4_02.jpg')), ('بالارفتن از کوه با قرار دادن دست ها روی مدیسینبال', ('Fitness\\Core\\Intermediate\\5_01.jpg',)), ('بالارفتن از کوه با قرار دادن پاها بر روی ولساید', ('Fitness\\Core\\Intermediate\\6_01.jpg',)), ('به عقب رفتن تنه روی زانو', ('Fitness\\Core\\Intermediate\\7_01.jpg', 'Fitness\\Core\\Intermediate\\7_02.jpg')), ('جمع کردن بدن روی فوم', ('Fitness\\Core\\Intermediate\\8_01.jpg', 'Fitness\\Core\\Intermediate\\8_02.jpg', 'Fitness\\Core\\Intermediate\\8_03.jpg')), ('جمع کردن پا داخل شکم', ('Fitness\\Core\\Intermediate\\9_01.jpg', 'Fitness\\Core\\Intermediate\\9_02.jpg')), ('حرکت دادن ران ها به صورت متقاطع بر روی توپ سوئیسی', ('Fitness\\Core\\Intermediate\\10_01.jpg', 'Fitness\\Core\\Intermediate\\10_02.jpg', 'Fitness\\Core\\Intermediate\\10_03.jpg')), ('حشره مرده', ('Fitness\\Core\\Intermediate\\11_01.jpg', 'Fitness\\Core\\Intermediate\\11_02.jpg')), ('دراز و نشست به صورت وی شکل تعدیل شده', ('Fitness\\Core\\Intermediate\\12_01.jpg', 'Fitness\\Core\\Intermediate\\12_02.jpg')), ('دراز و نشست به صورت وی شکل همراه با مدیسینبال', ('Fitness\\Core\\Intermediate\\13_01.jpg', 'Fitness\\Core\\Intermediate\\13_02.jpg')), ('دراز و نشست روی میز شیبدار به پایین', ('Fitness\\Core\\Intermediate\\14_01.jpg', 'Fitness\\Core\\Intermediate\\14_02.jpg')), ('شنا  روی فوم', ('Fitness\\Core\\Intermediate\\15_01.jpg', 'Fitness\\Core\\Intermediate\\15_02.jpg')), ('شنا کردن', ('Fitness\\Core\\Intermediate\\16_01.jpg', 'Fitness\\Core\\Intermediate\\16_02.jpg', 'Fitness\\Core\\Intermediate\\16_03.jpg')), ('شکم V', ('Fitness\\Core\\Intermediate\\17_01.jpg', 'Fitness\\Core\\Intermediate\\17_02.jpg', 'Fitness\\Core\\Intermediate\\17_03.jpg')), ('علتیدن پهلو توپ سوییسی', ('Fitness\\Core\\Intermediate\\18_01.jpg', 'Fitness\\Core\\Intermediate\\18_02.jpg')), ('پایداری به شکل t', ('Fitness\\Core\\Intermediate\\19_01.jpg', 'Fitness\\Core\\Intermediate\\19_02.jpg')), ('پایین آوردن پاها با کنترل', ('Fitness\\Core\\Intermediate\\20_01.jpg', 'Fitness\\Core\\Intermediate\\20_02.jpg')), ('پرتاب مدیسینبال به زمین', ('Fitness\\Core\\Intermediate\\21_01.jpg', 'Fitness\\Core\\Intermediate\\21_02.jpg', 'Fitness\\Core\\Intermediate\\21_03.jpg')), ('پرتاب مدیسینبال به کنار', ('Fitness\\Core\\Intermediate\\22_01.jpg', 'Fitness\\Core\\Intermediate\\22_02.jpg', 'Fitness\\Core\\Intermediate\\22_03.jpg')), ('پرس عصلات مرکزی بدن سیم کش', ('Fitness\\Core\\Intermediate\\23_01.jpg', 'Fitness\\Core\\Intermediate\\23_02.jpg')), ('پلانک بالا کشیدن تک پا', ('Fitness\\Core\\Intermediate\\24_01.jpg',)), ('پلانک به پشت', ('Fitness\\Core\\Intermediate\\25_01.jpg', 'Fitness\\Core\\Intermediate\\25_02.jpg', 'Fitness\\Core\\Intermediate\\25_03.jpg')), ('پلانک روی حوله', ('Fitness\\Core\\Intermediate\\26_01.jpg', 'Fitness\\Core\\Intermediate\\26_02.jpg')), ('پلانک زانوها به داخل و بالا', ('Fitness\\Core\\Intermediate\\27_01.jpg', 'Fitness\\Core\\Intermediate\\27_02.jpg', 'Fitness\\Core\\Intermediate\\27_03.jpg')), ('پلانک پاهای بالا تک پا  ', ('Fitness\\Core\\Intermediate\\28_01.jpg',)), ('پلانک پهلو تک پا', ('Fitness\\Core\\Intermediate\\29_01.jpg',)), ('پلانک پهلو پا روی نیمکت', ('Fitness\\Core\\Intermediate\\30_01.jpg',)), ('پلانک پهلو پارویی', ('Fitness\\Core\\Intermediate\\31_01.jpg', 'Fitness\\Core\\Intermediate\\31_02.jpg')), ('پلانک پهلو پلبومتریکی', ('Fitness\\Core\\Intermediate\\32_01.jpg', 'Fitness\\Core\\Intermediate\\32_02.jpg')), ('پلانک پهلو یک دسا زیر بدن', ('Fitness\\Core\\Intermediate\\33_01.jpg', 'Fitness\\Core\\Intermediate\\33_02.jpg')), ('چاپ ایستاده', ('Fitness\\Core\\Intermediate\\34_01.jpg', 'Fitness\\Core\\Intermediate\\34_02.jpg')), ('چاپ به صورت ایستاده و معکوس', ('Fitness\\Core\\Intermediate\\35_01.jpg', 'Fitness\\Core\\Intermediate\\35_02.jpg')), ('چاپ معکوس به صورت زانو زده یک پا', ('Fitness\\Core\\Intermediate\\36_01.jpg', 'Fitness\\Core\\Intermediate\\36_02.jpg')), ('چاپ معکوس چرخش زانو زده', ('Fitness\\Core\\Intermediate\\37_01.jpg', 'Fitness\\Core\\Intermediate\\37_02.jpg')), ('چاپ همراه با زانو زدن یک پا', ('Fitness\\Core\\Intermediate\\38_01.jpg', 'Fitness\\Core\\Intermediate\\38_02.jpg')), ('چاپ همراه با چرخش به صورت ایستاده1', ('Fitness\\Core\\Intermediate\\39_01.jpg', 'Fitness\\Core\\Intermediate\\39_02.jpg')), ('چاپ همراه با چرخش به صورت ایستاده', ('Fitness\\Core\\Intermediate\\40_01.jpg', 'Fitness\\Core\\Intermediate\\40_02.jpg')), ('چاپ همراه با چرخش به صورت دوبخشی و ایستاده', ('Fitness\\Core\\Intermediate\\41_01.jpg', 'Fitness\\Core\\Intermediate\\41_02.jpg')), ('چاپ همراه با چرخش به صورت زانو زدن با یک پا1', ('Fitness\\Core\\Intermediate\\42_01.jpg', 'Fitness\\Core\\Intermediate\\42_02.jpg')), ('چاپ همراه با چرخش به صورت زانو زدن با یک پا', ('Fitness\\Core\\Intermediate\\43_01.jpg', 'Fitness\\Core\\Intermediate\\43_02.jpg')), ('چاپ همراه با چرخش زانو زده', ('Fitness\\Core\\Intermediate\\44_01.jpg', 'Fitness\\Core\\Intermediate\\44_02.jpg')), ('چاپ همراه با چرخش، به صورت ایستادن دوبخشی', ('Fitness\\Core\\Intermediate\\45_01.jpg', 'Fitness\\Core\\Intermediate\\45_02.jpg')), ('چرخش روسی به همراه بالا نگه داشتن پاها', ('Fitness\\Core\\Intermediate\\46_01.jpg', 'Fitness\\Core\\Intermediate\\46_02.jpg', 'Fitness\\Core\\Intermediate\\46_03.jpg')), ('چرخش روسی به همراه رکاب زدن', ('Fitness\\Core\\Intermediate\\47_01.jpg', 'Fitness\\Core\\Intermediate\\47_02.jpg')), ('چرخش روسی روی توپ سوئیسی', ('Fitness\\Core\\Intermediate\\48_01.jpg', 'Fitness\\Core\\Intermediate\\48_02.jpg', 'Fitness\\Core\\Intermediate\\48_03.jpg')), ('چرخش هیپ', ('Fitness\\Core\\Intermediate\\49_01.jpg', 'Fitness\\Core\\Intermediate\\49_02.jpg', 'Fitness\\Core\\Intermediate\\49_03.jpg')), ('چرخشی', ('Fitness\\Core\\Intermediate\\50_01.jpg', 'Fitness\\Core\\Intermediate\\50_02.jpg', 'Fitness\\Core\\Intermediate\\50_03.jpg', 'Fitness\\Core\\Intermediate\\50_04.jpg')), ('چهار دست و پا بالا اوردن دست و پای مخالف روی توپ سوییسی ', ('Fitness\\Core\\Intermediate\\51_01.jpg',)), ('کرانچ ابتدایی', ('Fitness\\Core\\Intermediate\\52_01.jpg', 'Fitness\\Core\\Intermediate\\52_02.jpg', 'Fitness\\Core\\Intermediate\\52_03.jpg', 'Fitness\\Core\\Intermediate\\52_04.jpg', 'Fitness\\Core\\Intermediate\\52_05.jpg')), ('کرانچ با سیم کش ایستاده', ('Fitness\\Core\\Intermediate\\53_01.jpg', 'Fitness\\Core\\Intermediate\\53_02.jpg')), ('کرانچ با کابل زانو زده', ('Fitness\\Core\\Intermediate\\54_01.jpg', 'Fitness\\Core\\Intermediate\\54_02.jpg')), ('کرانچ به طرفین توپ سوییسی', ('Fitness\\Core\\Intermediate\\55_01.jpg', 'Fitness\\Core\\Intermediate\\55_02.jpg')), ('کرانچ روی توپ سوئیسی با حمل وزنه', ('Fitness\\Core\\Intermediate\\56_01.jpg', 'Fitness\\Core\\Intermediate\\56_02.jpg')), ('کرانچ روی توپ سوییسی', ('Fitness\\Core\\Intermediate\\57_01.jpg', 'Fitness\\Core\\Intermediate\\57_02.jpg')), ('کرانچ معکوس با فوم غلتان همراه با دمبل', ('Fitness\\Core\\Intermediate\\58_01.jpg', 'Fitness\\Core\\Intermediate\\58_02.jpg')), ('کرانچ معکوس با فوم غلتان همراه با مدیسینبال', ('Fitness\\Core\\Intermediate\\59_01.jpg', 'Fitness\\Core\\Intermediate\\59_02.jpg')), ('کرانچ معکوس روی توپ سوئیسی', ('Fitness\\Core\\Intermediate\\60_01.jpg', 'Fitness\\Core\\Intermediate\\60_02.jpg')), ('کرانچ معکوس روی میز با فوم غلتان', ('Fitness\\Core\\Intermediate\\61_01.jpg', 'Fitness\\Core\\Intermediate\\61_02.jpg')), ('کرانچ معکوس روی میز شیبدار به بالا', ('Fitness\\Core\\Intermediate\\62_01.jpg', 'Fitness\\Core\\Intermediate\\62_02.jpg', 'Fitness\\Core\\Intermediate\\62_03.jpg')), ('کرانچ مورب', ('Fitness\\Core\\Intermediate\\63_01.jpg', 'Fitness\\Core\\Intermediate\\63_02.jpg', 'Fitness\\Core\\Intermediate\\63_03.jpg')), ('کشیدن سیم کش به کنار بدن زانو زده معکوس', ('Fitness\\Core\\Intermediate\\64_01.jpg', 'Fitness\\Core\\Intermediate\\64_02.jpg')), ('کشیدن سیم کش به کنار بدن زانو زده', ('Fitness\\Core\\Intermediate\\65_01.jpg', 'Fitness\\Core\\Intermediate\\65_02.jpg'))]
"""
def save_object(obj,filename):
    try:
        with open(filename, "wb") as f:
            pickle.dump(obj, f, protocol=pickle.HIGHEST_PROTOCOL)
    except Exception as ex:
        print("Error during pickling object (Possibly unsupported):", ex)
def load_object(filename):
    try:
        with open(filename, "rb") as f:
            return pickle.load(f)
    except Exception as ex:
        print("Error during unpickling object (Possibly unsupported):", ex)

def group_names(name_list):
    names={}
    for name in name_list:
        mach = re.search(r'_\d+[.](jpg|png)',name)
        if mach==None:
            names[name[:-4]]=[name]
        else:
            try:
                names[name[:mach.span()[0]]].append(name)
            except:
                names[name[:mach.span()[0]]]=[name]
    return [(key,value) for key,value in names.items()]

def random_name_list(n,root):
    result = []
    folders = {}
    for dir_path, dir_names, file_names in walk(root):
        names = [i for i in file_names if i.endswith('.jpg') or i.endswith('.png')]
        if len(names):  folders[dir_path]=names
    names = list(folders.keys())
    if names==[]:   return []
    ls = random.choices(names,weights=[len(group_names(folders[folder])) for folder in names],k=n) if len(names)<n else random.sample(names,k=n)
    for path in ls:
        result.append((path,random.choice(group_names(folders[path]))))
    return result

print(load_object('data'))